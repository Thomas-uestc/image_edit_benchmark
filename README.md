# Image Edit Benchmark Pipeline

å›¾åƒç¼–è¾‘æ¨¡å‹è¯„æµ‹ç³»ç»Ÿ - ç”¨äºåœ¨benchmarkæ•°æ®é›†ä¸Šæµ‹è¯•æ‰©æ•£ç¼–è¾‘æ¨¡å‹çš„æ€§èƒ½

## ğŸ“ é¡¹ç›®ç»“æ„

```
image_edit_benchmark/
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt              # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ config.yaml                   # é…ç½®æ–‡ä»¶
â”œâ”€â”€ config_template.yaml          # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ main.py                       # ä¸»å…¥å£è„šæœ¬
â”‚
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pipeline.py               # ä¸»Pipelineç±»
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                     # æ•°æ®åŠ è½½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ benchmark_loader.py   # Benchmarkæ•°æ®åŠ è½½å™¨
â”‚   â”‚   â””â”€â”€ data_types.py         # æ•°æ®ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                   # æ¨¡å‹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py               # æ¨¡å‹åŸºç±»å®šä¹‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ diffusion/            # æ‰©æ•£ç¼–è¾‘æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base_diffusion.py # æ‰©æ•£æ¨¡å‹æŠ½è±¡åŸºç±»
â”‚   â”‚   â”‚   â””â”€â”€ implementations/  # å…·ä½“å®ç°
â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚       â”œâ”€â”€ example_model.py
â”‚   â”‚   â”‚       â””â”€â”€ custom_model.py
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ reward/               # Rewardè¯„åˆ†æ¨¡å‹
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ base_reward.py    # Rewardæ¨¡å‹æŠ½è±¡åŸºç±»
â”‚   â”‚       â””â”€â”€ implementations/  # å…·ä½“å®ç°
â”‚   â”‚           â”œâ”€â”€ __init__.py
â”‚   â”‚           â”œâ”€â”€ example_reward.py
â”‚   â”‚           â””â”€â”€ custom_reward.py
â”‚   â”‚
â”‚   â”œâ”€â”€ evaluation/               # è¯„ä¼°æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ scorer.py             # è¯„åˆ†ç»Ÿè®¡å™¨
â”‚   â”‚   â””â”€â”€ reporter.py           # æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ image_utils.py        # å›¾åƒå¤„ç†å·¥å…·
â”‚       â”œâ”€â”€ logger.py             # æ—¥å¿—å·¥å…·
â”‚       â””â”€â”€ prompt_manager.py     # Promptç®¡ç†å™¨
â”‚
â”œâ”€â”€ configs/                      # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ prompts/                  # Prompté…ç½®
â”‚   â”‚   â”œâ”€â”€ category_prompts.yaml # å„ç±»åˆ«çš„è¯„åˆ†prompt
â”‚   â”‚   â””â”€â”€ default_prompts.yaml  # é»˜è®¤prompt
â”‚   â””â”€â”€ models/                   # æ¨¡å‹é…ç½®
â”‚       â”œâ”€â”€ diffusion_config.yaml # æ‰©æ•£æ¨¡å‹é…ç½®
â”‚       â””â”€â”€ reward_config.yaml    # Rewardæ¨¡å‹é…ç½®
â”‚
â”œâ”€â”€ examples/                     # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ run_evaluation.py         # è¿è¡Œè¯„æµ‹ç¤ºä¾‹
â”‚   â””â”€â”€ custom_model_example.py   # è‡ªå®šä¹‰æ¨¡å‹ç¤ºä¾‹
â”‚
â”œâ”€â”€ outputs/                      # è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ results/                  # è¯„æµ‹ç»“æœ
â”‚   â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ images/                   # ç”Ÿæˆçš„å›¾åƒï¼ˆå¯é€‰ï¼‰
â”‚
â””â”€â”€ tests/                        # æµ‹è¯•ä»£ç 
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ test_data_loader.py
    â”œâ”€â”€ test_models.py
    â””â”€â”€ test_pipeline.py
```

## ğŸ¯ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. æ•°æ®åŠ è½½æ¨¡å— (`src/data/`)
- è¯»å–benchmark JSONæ–‡ä»¶
- æŒ‰ç±»åˆ«ç»„ç»‡æ•°æ®ï¼ˆåŸå›¾b64ã€ç¼–è¾‘æŒ‡ä»¤ã€åŸå›¾æè¿°ï¼‰
- æä¾›æ•°æ®è¿­ä»£å™¨

### 2. æ‰©æ•£ç¼–è¾‘æ¨¡å‹æ¨¡å— (`src/models/diffusion/`)
- æŠ½è±¡åŸºç±»å®šä¹‰ç»Ÿä¸€æ¥å£
- æ”¯æŒå¤šç§æ‰©æ•£æ¨¡å‹å®ç°
- ä¾¿äºæ›¿æ¢å’Œæ‰©å±•

### 3. Rewardè¯„åˆ†æ¨¡å‹æ¨¡å— (`src/models/reward/`)
- æŠ½è±¡åŸºç±»å®šä¹‰ç»Ÿä¸€æ¥å£
- æŒ‰ç±»åˆ«ä½¿ç”¨ä¸åŒprompt
- æ”¯æŒå¤šç§è¯„åˆ†æ¨¡å‹

### 4. è¯„ä¼°æ¨¡å— (`src/evaluation/`)
- æŒ‰ç±»åˆ«è®¡ç®—å¹³å‡åˆ†
- ç”Ÿæˆè¯¦ç»†è¯„æµ‹æŠ¥å‘Š
- æ”¯æŒå¤šç§ç»Ÿè®¡æŒ‡æ ‡

### 5. Pipeline (`src/pipeline.py`)
- æ•´åˆæ‰€æœ‰æ¨¡å—
- æ§åˆ¶è¯„æµ‹æµç¨‹
- æ”¯æŒæ–­ç‚¹ç»­ä¼ 

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### é…ç½®æ¨¡å‹
```bash
cp config_template.yaml config.yaml
# ç¼–è¾‘ config.yamlï¼Œé…ç½®ä½ çš„æ¨¡å‹å’Œå‚æ•°
```

### è¿è¡Œè¯„æµ‹
```bash
python main.py --config config.yaml
```

## ğŸ“ ä½¿ç”¨è¯´æ˜

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒå„æ¨¡å—çš„æ–‡æ¡£ã€‚

## ğŸ”§ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æ‰©æ•£ç¼–è¾‘æ¨¡å‹
1. åœ¨ `src/models/diffusion/implementations/` åˆ›å»ºæ–°çš„å®ç°æ–‡ä»¶
2. ç»§æ‰¿ `BaseDiffusionModel` ç±»
3. å®ç° `edit_image()` æ–¹æ³•
4. åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæ¨¡å‹ç±»

### æ·»åŠ æ–°çš„Rewardæ¨¡å‹
1. åœ¨ `src/models/reward/implementations/` åˆ›å»ºæ–°çš„å®ç°æ–‡ä»¶
2. ç»§æ‰¿ `BaseRewardModel` ç±»
3. å®ç° `score()` æ–¹æ³•
4. åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæ¨¡å‹ç±»

## ğŸ“Š è¯„æµ‹æµç¨‹

1. åŠ è½½benchmarkæ•°æ®é›†ï¼ˆJSONï¼‰
2. æŒ‰ç±»åˆ«æå–ï¼šåŸå›¾b64ã€ç¼–è¾‘æŒ‡ä»¤ã€åŸå›¾æè¿°
3. è°ƒç”¨æ‰©æ•£ç¼–è¾‘æ¨¡å‹ç”Ÿæˆç¼–è¾‘åçš„å›¾åƒ
4. è°ƒç”¨Rewardæ¨¡å‹å¯¹æ¯ä¸ªpairè¿›è¡Œè¯„åˆ†
5. æŒ‰ç±»åˆ«è®¡ç®—å¹³å‡åˆ†
6. ç”Ÿæˆå®Œæ•´è¯„æµ‹æŠ¥å‘Š

## ğŸ“„ License

MIT License


